#context.modules = [
#	{ name = libpipewire-module-filter-chain
#		args = {
#			node.description = "EBU R128 Normalizer"
#			media.name = "EBU R128 Normalizer"
#			filter.graph = {
#				nodes = [
#					{ type = builtin name = EQL label = convolver config = { filename = "/home/justcausewhynot/.config/pipewire/pipewire.conf.d/560.wav" channel = 1 resample_quality = 5 } }
#					{ type = builtin name = EQR label = convolver config = { filename = "/home/justcausewhynot/.config/pipewire/pipewire.conf.d/560.wav" channel = 2 resample_quality = 5 } }
#					{ name = ebur128 type = ebur128 label = ebur128 }
#					{ name = lufsL type = ebur128 label = lufs2gain control = { "Target LUFS" = -23.0 } }
#					{ name = lufsR type = ebur128 label = lufs2gain control = { "Target LUFS" = -23.0 } }
#					{ name = volumeL type = builtin label = linear }
#					{ name = volumeR type = builtin label = linear }
#				]
#				links = [
#
#					{ output = "ebur128:Out FL" input = "volumeL:In" }
#					{ output = "ebur128:Global LUFS" input = "lufsL:LUFS" }
#					{ output = "lufsL:Gain" input = "volumeL:Mult" }
#
#					{ output = "ebur128:Out FR" input = "volumeR:In" }
#					{ output = "ebur128:Global LUFS" input = "lufsR:LUFS" }
#					{ output = "lufsR:Gain" input = "volumeR:Mult" }
#				]
#
#				inputs  = [ "EQL:Out"  "EQR:Out" ]
#				outputs = [ "volumeL:Out" "volumeR:Out" ]
#			}
#			capture.props = {
#				# Combined properties from
#				node.name = "EBU R128 Input"
#				audio.channels = 2
#				audio.position = [ FL FR ]
#				media.class = Audio/Sink
#			}
#			playback.props = {
#				node.name = "EBU R128 Output"
#				audio.channels = 2
#				audio.position = [ FL FR ]
#				target.object = "alsa_output.usb-MOTU_M2_M2MT15C48F-00.HiFi__hw_M2__sink"
#				node.passive = true
#			}
#		}
#	}
#]

context.modules = [
{ name = libpipewire-module-filter-chain
	args = {
		node.description = "EBU R128 Normalizer"
		media.name = "EBU R128 Normalizer"
		filter.graph = {
			nodes = [
				{ name = ebur128 type = ebur128 label = ebur128 }

				{ name = lufsL type = ebur128 label = lufs2gain control = { "Target LUFS" = -23.0 } }
				{ name = lufsR type = ebur128 label = lufs2gain control = { "Target LUFS" = -23.0 } }

				{ name = volumeL type = builtin label = linear }
				{ name = volumeR type = builtin label = linear }
				]
				links = [
				{ output = "ebur128:Out FL" input = "volumeL:In" }
				{ output = "ebur128:Global LUFS" input = "lufsL:LUFS" }
				{ output = "lufsL:Gain" input = "volumeL:Mult" }
				{ output = "ebur128:Out FR" input = "volumeR:In" }
				{ output = "ebur128:Global LUFS" input = "lufsR:LUFS" }
				{ output = "lufsR:Gain" input = "volumeR:Mult" }
				]

				inputs  = [ "ebur128:In FL"  "ebur128:In FR" ]
				outputs = [ "volumeL:Out" "volumeR:Out" ]
		}
		capture.props = {
			node.name = "ebur128.input"
			node.description = "ebur128.input"
			audio.position = [ FL FR  ]
			media.class = Audio/Sink
		}
		playback.props = {
			node.name = "ebur128.output"
			node.description = "ebur128.output"
			audio.position = [ FL FR ]
			target.object = "eq.input"
			#node.passive = true
		}
	}
}
]
